<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Get the top 10 AI agents news stories delivered to your inbox daily. Focused on autonomous AI, agent frameworks, and agentic systems.">
  <title>Agent News - Daily AI Agents Newsletter</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: ui-sans-serif, system-ui, sans-serif;
      font-weight: 400;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
  </style>
</head>
<body class="bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-100">
  <main class="max-w-xl mx-auto px-6 py-16 min-h-screen flex flex-col gap-8">

    <!-- Header -->
    <section class="">
      <div id="dino-container" class="mb-4">
        <div id="dino" class="text-xs font-mono flex gap-2 pb-2">
          <div class="flex flex-col items-center justify-center text-amber-300 dark:text-amber-600">
            <span class="block">;</span>
            <span class="block">["]</span>
            <span class="block">/[_]\</span>
            <span class="block">] [</span>
          </div>
          <div class="flex flex-col items-center justify-center text-amber-400 dark:text-amber-500">
            <span class="block">;</span>
            <span class="block">["]</span>
            <span class="block">/[_]\</span>
            <span class="block">] [</span>
          </div>
          <div class="flex flex-col items-center justify-center text-amber-500 dark:text-amber-400">
            <span class="block">;</span>
            <span class="block">["]</span>
            <span class="block">/[_]\</span>
            <span class="block">] [</span>
          </div>
        </div>
      </div>
      <h1 class="text-xl font-normal mb-2">Agent News</h1>

      <p class=" text-slate-600 dark:text-slate-400">
        Top 10 AI agents stories, delivered every morning
      </p>
    </section>

    <!-- About -->
    <section class="">
      <h3 class="mb-3 font-normal text-slate-400 dark:text-slate-700">About</h3>
      <div class="text-slate-600 dark:text-slate-400 leading-relaxed">
        <p class="mb-3">
          A daily newsletter focused exclusively on AI agents - autonomous AI systems that use tools, make decisions, and take actions.
        </p>
        <p>
          Every morning at 8:00 AM UTC, our autonomous agents search the web for breaking news about AI agents,
          analyze hundreds of articles, and select the top 10 stories about agentic AI that matter most.
        </p>
      </div>
    </section>

    <!-- Subscribe -->
    <section class="flex-grow">
      <h3 class="mb-3 font-normal text-slate-400 dark:text-slate-700">Subscribe</h3>
      <form id="signupForm" class="max-w-md flex flex-col gap-1">
        <div class="flex-1 flex flex-col md:flex-row gap-3">
          <input
            type="email"
            id="email"
            name="email"
            placeholder="your@email.com"
            required
            autocomplete="email"
            style="font-size: 16px;"
            class="flex-1 px-4 py-2.5 border border-slate-200 dark:border-slate-800 rounded-md
                    bg-white dark:bg-slate-900 text-slate-900 dark:text-slate-100
                    placeholder:text-slate-400 dark:placeholder:text-slate-500
                    focus:outline-none focus:ring-2 focus:ring-slate-400 dark:focus:ring-slate-600
                    transition-all"
          >
          <button
            type="submit"
            id="submitBtn"
            class="px-4 py-2.5  bg-slate-900 dark:bg-slate-100 text-white dark:text-slate-900
                    rounded-md hover:bg-slate-800 dark:hover:bg-slate-200
                    transition-colors disabled:opacity-50 disabled:cursor-not-allowed
                    font-normal"
          >
            Subscribe
          </button>
        </div>
        <div id="message" class="mt-3  hidden"></div>
      </form>
    </section>

    <!-- Footer -->
    <footer class="pt-6  text-slate-400 dark:text-slate-500">
      <p>
        Powered by AI agents • Built by <a href="https://toy.studio" target="_blank" rel="noopener noreferrer" class="text-amber-400 dark:text-amber-500 hover:text-amber-600 dark:hover:text-amber-300 transition-colors">toy.studio</a> •
        <a href="https://github.com/toy-studio/agent-news" target="_blank" rel="noopener noreferrer" class="">view source</a>
      </p>
    </footer>

  </main>

  <script>
    const form = document.getElementById('signupForm');
    const emailInput = document.getElementById('email');
    const submitBtn = document.getElementById('submitBtn');
    const messageDiv = document.getElementById('message');

    function showMessage(text, type) {
      messageDiv.textContent = text;
      messageDiv.className = `mt-3  ${
        type === 'success'
          ? 'text-green-600 dark:text-green-400'
          : 'text-red-600 dark:text-red-400'
      }`;
      messageDiv.classList.remove('hidden');
    }

    // Check for confirmation or error in URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    const confirmEmail = urlParams.get('confirm');
    const already = urlParams.get('already');
    const error = urlParams.get('error');

    if (confirmEmail) {
      // Show success message for confirmed subscription
      const message = already === 'true'
        ? `✓ ${decodeURIComponent(confirmEmail)} is already subscribed!`
        : `✓ Success! ${decodeURIComponent(confirmEmail)} has been confirmed. You're all set!`;
      showMessage(message, 'success');
      // Clean up URL
      window.history.replaceState({}, document.title, window.location.pathname);
    } else if (error) {
      // Show error message
      const errorMessage = decodeURIComponent(error);
      showMessage(errorMessage === 'missing_email' ? 'Missing email address.' :
                  errorMessage === 'missing_contact_id' ? 'Missing confirmation link.' :
                  errorMessage === 'invalid_email' ? 'Invalid email address.' :
                  errorMessage === 'contact_not_found' ? 'Invalid or expired confirmation link. Please subscribe again.' :
                  errorMessage === 'email_mismatch' ? 'Email verification failed.' :
                  errorMessage === 'server_error' ? 'Server configuration error.' :
                  errorMessage === 'unexpected_error' ? 'An unexpected error occurred.' :
                  errorMessage, 'error');
      // Clean up URL
      window.history.replaceState({}, document.title, window.location.pathname);
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const email = emailInput.value.trim();

      if (!email) {
        showMessage('Please enter your email address', 'error');
        return;
      }

      submitBtn.disabled = true;
      submitBtn.textContent = 'Subscribing...';
      messageDiv.classList.add('hidden');

      try {
        const response = await fetch('/api/subscribe', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ email }),
        });

        const data = await response.json();

        if (response.ok && data.success) {
          showMessage('✓ Success! Check your email to confirm.', 'success');
          emailInput.value = '';
        } else {
          showMessage(data.error || 'Something went wrong. Please try again.', 'error');
        }
      } catch (error) {
        console.error('Signup error:', error);
        showMessage('Network error. Please check your connection.', 'error');
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Subscribe';
      }
    });

    // Dinosaur jumping animation
    const dino = document.getElementById('dino');
    let isJumping = false;

    document.addEventListener('keydown', (event) => {
      if (event.code === 'Space' && !isJumping) {
        isJumping = true;
        dino.classList.add('jumping');

        // Remove the 'jumping' class after the animation completes
        dino.addEventListener('animationend', () => {
          dino.classList.remove('jumping');
          isJumping = false;
        }, { once: true });
      }
    });

    // Auto-focus email input on desktop only (avoid zoom on mobile)
    if (window.innerWidth > 768) {
      emailInput.focus();
    }

    // Dark mode support
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      document.documentElement.classList.add('dark');
    }
  </script>
</body>
</html>
